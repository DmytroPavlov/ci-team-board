<mat-card class="example-card">
  <mat-card-header>
    <!--<div mat-card-avatar class="example-header-image"></div> -->
    <mat-card-title>
      {{ project.name }}
    </mat-card-title>
    <mat-card-subtitle>last run pipeline</mat-card-subtitle>
  </mat-card-header>
  <mat-card-content>
    <mat-accordion>
      <mat-expansion-panel
        *ngFor="let projectRun of _projectRuns | async"
        (opened)="onProjectRunDetailsOpened(projectRun)"
        hideToggle
      >
        <mat-expansion-panel-header>
          <mat-panel-title> #{{ projectRun.id }} </mat-panel-title>
          <mat-panel-title>
            {{ projectRun.result }}
          </mat-panel-title>
          <mat-panel-title>
            {{ projectRun.durationInMillis | amDuration: 'milliseconds' }}
          </mat-panel-title>
        </mat-expansion-panel-header>
        <mat-chip-list>
          <mat-chip
            [color]="primary"
            *ngFor="let projectRunNode of _projectRunNodes | async"
          >
            {{ projectRunNode.displayName }}
          </mat-chip>
        </mat-chip-list>
        <mat-tab-group>
          <mat-tab>
            <ng-template matTabLabel>
              <span
                matBadge="{{ projectRun.changeSet.length }}"
                matBadgeOverlap="false"
              >
                Change set
              </span>
            </ng-template>
            <ng-template matTabContent>
              <table matSort (matSortChange)="sortData($event)">
                <tr *ngFor="let changeSet of projectRun.changeSet">
                  <td style="vertical-align: top;">
                    <img
                      ngxGravatar
                      [size]="48"
                      [email]="changeSet.author.email"
                    />
                  </td>
                  <td style="vertical-align: top;">
                    <b>{{ changeSet.author.fullName }}</b>
                  </td>
                  <td style="vertical-align: top;">
                    {{ changeSet.msg }}
                  </td>
                  <td style="vertical-align: top;">
                    <div *ngFor="let affectedPath of changeSet.affectedPaths">
                      <span>- {{ affectedPath }}</span>
                    </div>
                  </td>
                </tr>
              </table>
            </ng-template>
          </mat-tab>
        </mat-tab-group>
      </mat-expansion-panel>
    </mat-accordion>
  </mat-card-content>
</mat-card>
